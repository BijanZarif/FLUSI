#!/bin/bash

# convert files from mpi format to a Fortran-readable format

# usage: 
# convert_mpiio_duke.script <NX> <NY> <NZ>
# where NX, NY, and NZ are the number of elements in each dimension

USAGE="convert_mpiio_duke.script <NX> <NY> <NZ>"

if [ "$1" == "" ]; then
    echo "need to specify NX"
    echo $USAGE
    exit 1
fi
if [ "$2" == "" ]; then
    echo "need to specify NY"
    echo $USAGE
    exit 1
fi
if [ "$3" == "" ]; then
    echo "need to specify NZ"
    echo $USAGE
    exit 1
fi

NX=$1
NY=$2
NZ=$3


for file in *.mpiio
do
  echo "processing file $file"
  covert_mpiio2binary.out ${file%%.mpiio} ${NX} ${NY} ${NZ} 0
done

